{"version":3,"sources":["webpack://[name]/./src/state-diagram/StateViz.css","webpack://[name]/./src/tape/tape.css","webpack://[name]/./src/TMViz.js","webpack://[name]/./src/TuringMachine.js","webpack://[name]/./src/state-diagram/StateGraph.js","webpack://[name]/./src/state-diagram/StateViz.js","webpack://[name]/./src/tape/Tape.js","webpack://[name]/./src/tape/TapeViz.js","webpack://[name]/./src/util.js","webpack://[name]/./src/watch.js","webpack://[name]/external \"_\"","webpack://[name]/external \"d3\"","webpack://[name]/external \"lodash\"","webpack://[name]/webpack/bootstrap","webpack://[name]/webpack/startup","webpack://[name]/webpack/runtime/define property getters","webpack://[name]/webpack/runtime/hasOwnProperty shorthand","webpack://[name]/webpack/runtime/make namespace object","webpack://[name]/webpack/runtime/publicPath"],"names":["TuringMachine","TapeViz","StateGraph","StateViz","watchInit","d3","pulseEdge","edge","select","domNode","classed","transition","style","duration","each","this","addTape","div","spec","append","attr","blank","input","String","split","module","exports","posTable","graph","table","stateviz","getVertexMap","getEdges","undefined","positionTable","edgeAnimation","stepInterval","self","machine","animationCallback","state","symbol","tuple","getInstructionAndEdge","isRunning","step","instruction","animatedTransition","startState","prop","oldstate","newstate","getVertex","isHalted","counter","Object","defineProperty","configurable","get","set","value","__parentDiv","__spec","index","document","querySelector","innerHTML","curState","entries","key","move","curSymbol","toString","tape","remove","instruct","nextInstruction","write","direction","MoveHead","right","headRight","left","headLeft","neutral","headNeutral","TypeError","defineProperties","prototype","read","enumerable","freeze","MoveTape","_","normalize","defaults","visibleSpace","c","derived","mapValues","transitions","label","allEdges","forEach","vertex","stateTransitions","cache","symbolKey","symbols","reduce","acc","x","length","push","target","tap","source","labels","bind","edgeTo","action","rightSide","map","join","labelFor","edges","deriveGraph","__graph","__edges","Error","isBrowserIEorEdge","assign","addV","array1","array2","i","subtractV","normV","array","Math","sqrt","y","normSqV","vectorFromLengthAngle","angle","cos","sin","EdgeCounter","e","src","EdgeShape","loop","numEdgesFromTo","arc","straight","identity","noop","limitRange","min","max","appendSVGTo","hwRatio","width","height","position","top","getPositionTable","pick","container","nodes","linkArray","w","h","nodeRadius","colors","scale","category10","svg","nodeArray","Array","values","__stateMap","force","layout","links","size","linkDistance","charge","theta","gravity","start","drag","on","d","fixed","edgeCounter","edgegroups","selectAll","data","enter","labelAbove","labelBelow","edgeD","edgeIndex","group","edgepath","text","shape","shapeForEdge","isFlipped","getPath","loopEndOffset","loopArc","PI","p1","p2","offset","radius","atan2","angleV","sep","n","unitV","scalar","edgePathFor","refreshLabels","svgrect","getBBox","shouldFlip","edgepaths","nodeSelection","nodecircles","resume","call","nodelabels","lastIndexOf","svgCSS","styleSheet","cssText","textContent","cx","cy","every","stop","stateMap","node","setPositionTable","writable","before","after","slice","reverse","last","pop","isEmpty","end","range","readOffset","Tape","initTapeCells","selection","datum","cellWidth","cellHeight","positionCells","repositionWrapper","wrapper","moveHead","exit","wOffset","cOffset","lookaround","super","readRange","childNodes","insert","Boolean","documentMode","window","StyleMedia","nonNull","coalesce","a","b","applyMaybe","f","getFirst","xs","val","toDocFragment","result","createDocumentFragment","appendChild","watch","thisArg","handler","desc","getOwnPropertyDescriptor","accessors","newval","lodash","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","definition","o","obj","hasOwnProperty","r","Symbol","toStringTag","p"],"mappings":"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","file":"TMViz.bundle.js","sourcesContent":["export default __webpack_public_path__ + \"state-diagram/StateViz.css\";","export default __webpack_public_path__ + \"tape/tape.css\";","'use strict';\n\n/**\n * Turing machine visualization component.\n *\n * â€¢ Adds running and reset on top of the base Turing machine.\n * â€¢ Displays an animated state diagram and tape diagram.\n * Does not include UI elements for controlling the machine.\n *\n * @module\n */\n\nconst { TuringMachine } = require('./TuringMachine');\n\nconst TapeViz = require('./tape/TapeViz');\nconst StateGraph = require('./state-diagram/StateGraph');\nconst StateViz = require('./state-diagram/StateViz');\nconst { watchInit } = require('./watch');\nconst d3 = require('d3');\n\n/**\n * Create an animated transition function.\n * @param  {StateGraph} graph\n * @param  {LayoutEdge -> any} animationCallback\n * @return {(string, string) -> Instruction} Created transition function.\n */\nfunction animatedTransition(graph, animationCallback) {\n  return (state, symbol) => {\n    const tuple = graph.getInstructionAndEdge(state, symbol);\n    if (tuple == null) { return null; }\n\n    animationCallback(tuple.edge);\n    return tuple.instruction;\n  };\n}\n\n/**\n * Default edge animation callback.\n * @param  {{domNode: Node}} edge\n * @return {D3Transition} The animation. Use this for transition chaining.\n */\nfunction pulseEdge(edge) {\n  const edgepath = d3.select(edge.domNode);\n  return edgepath\n    .classed('active-edge', true)\n    .transition()\n    .style('stroke-width', '3px')\n    .transition()\n    .style('stroke-width', '1px')\n    .transition()\n    .duration(0)\n    .each('start', /* @this edge */ function () {\n      d3.select(this).classed('active-edge', false);\n    })\n    .style('stroke', null)\n    .style('stroke-width', null);\n}\n\nfunction addTape(div, spec) {\n  return new TapeViz(div.append('svg').attr('class', 'tm-tape'), 9,\n    spec.blank, spec.input ? String(spec.input).split('') : []);\n}\n\n/* global document */\n\n/**\n * Construct a new state and tape visualization inside a &lt;div&gt;.\n * @constructor\n * @param {HTMLDivElement} div        div to take over and use.\n * @param                  spec       machine specification\n * @param {PositionTable} [posTable]  position table for the state nodes\n */\nclass TMViz {\n  constructor(div, spec, posTable) {\n    div = d3.select(div);\n    const graph = new StateGraph(spec.table);\n    this.stateviz = new StateViz(\n      div,\n      graph.getVertexMap(),\n      graph.getEdges()\n    );\n    if (posTable != undefined) { this.positionTable = posTable; }\n\n    this.edgeAnimation = pulseEdge;\n    this.stepInterval = 100;\n\n    const self = this;\n    // We hook into the animation callback to know when to start the next step (when running).\n    function animateAndContinue(edge) {\n      const transition = self.edgeAnimation(edge);\n      if (self.isRunning) {\n        transition.transition().duration(self.stepInterval).each('end', () => {\n          // stop if machine was paused during the animation\n          if (self.isRunning) { self.step(); }\n        });\n      }\n    }\n\n    this.machine = new TuringMachine(\n      animatedTransition(graph, animateAndContinue),\n      spec.startState,\n      addTape(div, spec)\n    );\n    // intercept and animate when the state is set\n    watchInit(this.machine, 'state', (prop, oldstate, newstate) => {\n      d3.select(graph.getVertex(oldstate).domNode).classed('current-state', false);\n      d3.select(graph.getVertex(newstate).domNode).classed('current-state', true);\n      return newstate;\n    });\n\n    // Sidenote: each \"Step\" click evaluates the transition function once.\n    // Therefore, detecting halting always requires its own step (for consistency).\n    this.isHalted = false;\n    this.counter = 0;\n\n    let isRunning = false;\n    /**\n     * Set isRunning to true to run the machine, and false to stop it.\n     */\n    Object.defineProperty(this, 'isRunning', {\n      configurable: true,\n      get: function () { return isRunning; },\n      set: function (value) {\n        if (isRunning !== value) {\n          isRunning = value;\n          if (isRunning) { this.step(); }\n        }\n      }\n    });\n\n    this.__parentDiv = div;\n    this.__spec = spec;\n\n    let index = 0;\n    document.querySelector('.rules tbody').innerHTML = '';\n    document.querySelector('.states tbody').innerHTML = '';\n    for (let [curState, value] of Object.entries(spec.table)) {\n      if (value === null) {\n        document.querySelector('.rules tbody').innerHTML += `\n          <tr>\n            <td>${++index}</td>\n            <td>${curState}</td>\n            <td></td>\n            <td></td>\n            <td></td>\n            <td></td>\n          </tr>`;\n        continue;\n      }\n      for (let [key, { symbol, move, state }] of Object.entries(value)) {\n        for (let curSymbol of key.split(',')) {\n          document.querySelector('.rules tbody').innerHTML += `\n          <tr>\n            <td>${++index}</td>\n            <td>${curState}</td>\n            <td>${curSymbol}</td>\n            <td>${symbol || curSymbol}</td>\n            <td>${move.toString()}</td>\n            <td>${state || curState}</td>\n          </tr>`;\n        }\n      }\n    }\n  }\n\n  /**\n   * Step the machine immediately and interrupt any animations.\n   */\n  step() {\n    const step = this.machine.step();\n    if (!step) {\n      this.isRunning = false;\n      this.isHalted = true;\n    } else {\n      document.querySelector('.states tbody').innerHTML += `\n      <tr>\n        <td>${++this.counter}</td>\n        <td>${this.machine.tape.toString()}</td>\n        <td>${step.state}</td>\n      </tr>`;\n    }\n  }\n\n  /**\n   * Reset the Turing machine to its starting configuration.\n   */\n  reset() {\n    this.isRunning = false;\n    this.isHalted = false;\n    this.counter = 0;\n    this.machine.state = this.__spec.startState;\n    this.machine.tape.domNode.remove();\n    this.machine.tape = addTape(this.__parentDiv, this.__spec);\n  }\n\n  get positionTable() { return this.stateviz.positionTable; }\n  set positionTable(posTable) { this.stateviz.positionTable = posTable; }\n}\n\nmodule.exports = TMViz;\n","'use strict';\n\n/**\n * Construct a Turing machine.\n * @param {(state, symbol) -> ?{state: state, symbol: symbol, move: direction}}\n *   transition\n *   A transition function that, given *only* the current state and symbol,\n *   returns an object with the following properties: symbol, move, and state.\n *   Returning null/undefined halts the machine (no transition defined).\n * @param {state} startState  The state to start in.\n * @param         tape        The tape to use.\n */\nclass TuringMachine {\n  constructor(transition, startState, tape) {\n    this.transition = transition;\n    this.state = startState;\n    this.tape = tape;\n  }\n\n  toString() {\n    return String(this.state) + '\\n' + String(this.tape);\n  }\n\n  /**\n   * Step to the next configuration according to the transition function.\n   * @return {boolean} true if successful (the transition is defined),\n   *   false otherwise (machine halted)\n   */\n  step() {\n    const instruct = this.nextInstruction;\n    if (instruct == null) { return false; }\n\n    this.tape.write(instruct.symbol);\n    move(this.tape, instruct.move);\n    this.state = instruct.state;\n\n    return instruct;\n  }\n}\n\nObject.defineProperties(TuringMachine.prototype, {\n  nextInstruction: {\n    get: function () { return this.transition(this.state, this.tape.read()); },\n    enumerable: true\n  },\n  isHalted: {\n    get: function () { return this.nextInstruction == null; },\n    enumerable: true\n  }\n});\n\n// Allows for both notational conventions of moving the head or moving the tape\nfunction move(tape, direction) {\n  switch (direction) {\n    case MoveHead.right:   tape.headRight();   break;\n    case MoveHead.left:    tape.headLeft();    break;\n    case MoveHead.neutral: tape.headNeutral(); break;\n    default: throw new TypeError('not a valid tape movement: ' + String(direction));\n  }\n}\nvar MoveHead = Object.freeze({\n  left   : {toString: function () { return 'L'; } },\n  right  : {toString: function () { return 'R'; } },\n  neutral: {toString: function () { return 'N'; } }\n});\nconst MoveTape = Object.freeze({left: MoveHead.right, right: MoveHead.left, neutral: MoveHead.neutral});\n\nexports.MoveHead = MoveHead;\nexports.MoveTape = MoveTape;\nexports.TuringMachine = TuringMachine;\n","'use strict';\n\nconst _ = require('lodash');\n\n\n/* Interface\n  type TransitionTable = {\n    [state: string]: ?{\n      [symbol: string]: Instruction\n    }\n  };\n  type Instruction = { state?: string, symbol?: string };\n\n  type DiagramGraph = {\n    [state: string]: {\n      label: string,\n      transitions: ?{\n        [symbol: string]: {\n          instruction: Instruction,\n          edge: LayoutEdge\n        }\n      }\n    }\n  };\n  type LayoutEdge = { source: Object, target: Object, labels: [string] }\n */\n\n/**\n * Use a transition table to derive the graph (vertices & edges) for a D3 diagram.\n * Edges with the same source and target are combined.\n * NB. In addition to single symbols, comma-separated symbols are supported.\n * e.g. symbol string '0,1,,,I' -> symbols [0,1,',','I'].\n */\n// TransitionTable -> DiagramGraph\nfunction deriveGraph(table) {\n  // We need two passes, since edges may point at vertices yet to be created.\n  // 1. Create all the vertices.\n  const graph = _.mapValues(table, (transitions, state) => {\n    return {\n      label: state,\n      transitions\n    };\n  });\n  // 2. Create the edges, which can now point at any vertex object.\n  const allEdges = [];\n  _.forEach(graph, (vertex, state) => {\n\n    vertex.transitions = vertex.transitions && (() => {\n      const stateTransitions = {};\n\n      // Combine edges with the same source and target\n      const cache = {};\n      function edgeTo(target, label) {\n        const edge = cache[target] ||\n          _.tap(cache[target] = {\n            source: vertex,\n            target: graph[target],\n            labels: []\n          }, allEdges.push.bind(allEdges));\n        edge.labels.push(label);\n        return edge;\n      }\n      // Create symbol -> instruction object map\n      _.forEach(vertex.transitions, (instruct, symbolKey) => {\n        // Handle comma-separated symbols.\n        // Recreate array by splitting on ','. Treat 2 consecutive ',' as , ','.\n        const symbols = symbolKey.split(',').reduce((acc, x) => {\n          if (x === '' && acc[acc.length-1] === '') {\n            acc[acc.length-1] = ',';\n          } else {\n            acc.push(x);\n          }\n          return acc;\n        }, []);\n        const target = instruct.state != null ? instruct.state : state;\n        const edge = edgeTo(target, labelFor(symbols, instruct));\n\n        symbols.forEach(symbol => {\n          stateTransitions[symbol] = {\n            // Normalize for execution, but display the less-cluttered original.\n            instruction: normalize(state, symbol, instruct),\n            edge\n          };\n        });\n      });\n\n      return stateTransitions;\n    })();\n\n  });\n\n  return {graph, edges: allEdges};\n}\n\n// Normalize an instruction to include an explicit state and symbol.\n// e.g. {symbol: '1'} normalizes to {state: 'q0', symbol: '1'} when in state q0.\nfunction normalize(state, symbol, instruction) {\n  return _.defaults({}, instruction, {state, symbol});\n}\n\nfunction labelFor(symbols, action) {\n  const rightSide = ((action.symbol == null) ? '' : (visibleSpace(String(action.symbol)) + ','))\n    + String(action.move);\n  return symbols.map(visibleSpace).join(',') + 'â†’' + rightSide;\n}\n\n// replace ' ' with 'â£'.\nfunction visibleSpace(c) {\n  return (c === ' ') ? 'â£' : c;\n}\n\n\n/**\n * Aids rendering and animating a transition table in D3.\n *\n * â€¢ Generates the vertices and edges (\"nodes\" and \"links\") for a D3 diagram.\n * â€¢ Provides mapping of each state to its vertex and each transition to its edge.\n * @param {TransitionTable} table\n */\nclass StateGraph {\n  constructor(table) {\n    const derived = deriveGraph(table);\n    Object.defineProperties(this, {\n      __graph: { value: derived.graph },\n      __edges: { value: derived.edges }\n    });\n  }\n\n  /**\n   * D3 layout \"nodes\".\n   */\n  // StateGraph.prototype.getVertices = function () {\n  //   return _.values(this.__graph);\n  // };\n\n  /**\n   * Returns the mapping from states to vertices (D3 layout \"nodes\").\n   * @return { {[state: string]: Object} }\n   */\n  getVertexMap() {\n    return this.__graph;\n  }\n\n  /**\n   * D3 layout \"links\".\n   */\n  getEdges() {\n    return this.__edges;\n  }\n\n  /**\n   * Look up a state's corresponding D3 \"node\".\n   */\n  getVertex(state) {\n    return this.__graph[state];\n  }\n\n  getInstructionAndEdge(state, symbol) {\n    const vertex = this.__graph[state];\n    if (vertex === undefined) {\n      throw new Error('not a valid state: ' + String(state));\n    }\n\n    return vertex.transitions && vertex.transitions[symbol];\n  }\n}\n\n\nmodule.exports = StateGraph;\n","'use strict';\n\nconst { isBrowserIEorEdge } = require('../util');\nconst d3 = require('d3');\nconst _ = require('lodash/fp');\nconst { assign } = require('lodash'); // need mutable assign()\n\n// *** Arrays as vectors ***\n\n// Add vectors.\n// Note: dimensions are not checked. Missing dimensions become NaN.\nfunction addV(array1, array2) {\n  return array1.map((x, i) => { return x + array2[i]; });\n}\n\nfunction negateV(array) {\n  return array.map(x => { return -x; });\n}\n\nfunction subtractV(array1, array2) {\n  return addV(array1, negateV(array2));\n}\n\n// Scale the vector by a scalar.\nfunction multiplyV(array, scalar) {\n  return array.map(x => { return scalar*x; });\n}\n\n// Vector norm, squared\nfunction normSqV(array) {\n  function sq(x) { return x*x; }\n  function add(x, y) { return x + y; }\n  return array.map(sq).reduce(add, 0);\n}\n\n// Vector norm\nfunction normV(array) { return Math.sqrt(normSqV(array)); }\n\n// Return a copy of the vector rescaled as a unit vector (norm = 1).\nfunction unitV(array) {\n  const n = normV(array);\n  return array.map(x => { return x / n; });\n}\n\n// *** 2D Vectors ***\nfunction angleV(array) {\n  const x = array[0];\n  const y = array[1];\n  return Math.atan2(y, x);\n}\n\nfunction vectorFromLengthAngle(length, angle) {\n  return [Math.cos(angle) * length, Math.sin(angle) * length];\n}\n\n// *** Utilities ***\n\n// Count the directed edges that start at a given node and end at another.\n// Important: each node must have a unique .index property.\n// Example usage:\n// var counts = new EdgeCounter(edges);\n// var edgesFrom2To5 = counts.numEdgesFromTo(2,5);\n// var edgesFrom5to2 = counts.numEdgesFromTo(5,2);\nclass EdgeCounter {\n  constructor(edges) {\n    edges.forEach(function (e) {\n      const key = e.source.index +','+ e.target.index;\n      this[key] = (this[key] || 0) + 1;\n    }, this);\n  }\n\n  numEdgesFromTo(src, target) {\n    return this[String(src)+','+String(target)] || 0;\n  }\n\n  shapeForEdge(e) {\n    if (e.target.index === e.source.index) {\n      return EdgeShape.loop;\n    } else if (this.numEdgesFromTo(e.target.index, e.source.index)) {\n      // has returning edge => arc\n      return EdgeShape.arc;\n    } else {\n      return EdgeShape.straight;\n    }\n  }\n}\n\nconst EdgeShape = Object.freeze({\n  loop: {},     // self-loop: a->a\n  arc: {},      // curved arc: a->b when b->a exists\n  straight: {}  // straight edge: a->b when b->a does not exist\n});\n\n// create a function that will compute an edge's SVG 'd' attribute.\nfunction edgePathFor(nodeRadius, shape, d) {\n  // case: self-loop\n  let loopEndOffset;\n\n  let loopArc;\n  if (shape === EdgeShape.loop) {\n    // start at the top (90Â°), end slightly above the right (15Â°)\n    loopEndOffset = vectorFromLengthAngle(nodeRadius, -15 * Math.PI/180);\n    loopArc = ' a 19,27 45 1,1 ' + loopEndOffset[0] + ',' + (loopEndOffset[1]+nodeRadius);\n    return () => {\n      const x1 = d.source.x;\n      const y1 = d.source.y;\n      return 'M ' + x1 + ',' + (y1-nodeRadius) + loopArc;\n    };\n  }\n  // case: between nodes\n  if (shape === EdgeShape.arc) {\n    // sub-case: arc\n    return () => {\n      // note: p1 & p2 have to be delayed, to access x/y at the time of the call\n      const p1 = [d.source.x, d.source.y];\n      const p2 = [d.target.x, d.target.y];\n      const offset = subtractV(p2, p1);\n      const radius = 6/5*normV(offset);\n      // Note: SVG's y-axis is flipped, so vector angles are negative\n      // relative to standard coordinates (as used in Math.atan2).\n      // Proof: angle(r <cos Ï´, -sin Ï´>) = angle(r <cos -Ï´, sin -Ï´>) = -Ï´.\n      const angle = angleV(offset);\n      const sep = -Math.PI/2/2; // 90Â° separation, half on each side\n      const source = addV(p1, vectorFromLengthAngle(nodeRadius, angle+sep));\n      const target = addV(p2, vectorFromLengthAngle(nodeRadius, angle+Math.PI-sep));\n      // IDEA: consider http://www.w3.org/TR/SVG/paths.html#PathDataCubicBezierCommands\n      return (p1[0] <= p2[0])\n        ? 'M '+source[0]+' '+source[1]+' A '+radius+' '+radius+' 0 0,1 '+target[0]+' '+target[1]\n        : 'M '+target[0]+' '+target[1]+' A '+radius+' '+radius+' 0 0,0 '+source[0]+' '+source[1];\n    };\n  } else if (shape === EdgeShape.straight) {\n    return () => {\n      // sub-case: straight line\n      const p1 = [d.source.x, d.source.y];\n      const p2 = [d.target.x, d.target.y];\n      const offset = subtractV(p2, p1);\n      // avoid spurious errors when bounding causes node centers to coincide\n      if (offset[0] === 0 && offset[1] === 0) { return null; }\n\n      const target = subtractV(p2, multiplyV(unitV(offset), nodeRadius));\n      return 'M '+p1[0]+' '+p1[1]+' L '+ target[0] +' '+ target[1];\n    };\n  }\n}\n\nfunction rectCenter(svgrect) {\n  return {x: svgrect.x + svgrect.width/2,\n    y: svgrect.y + svgrect.height/2};\n}\n\nfunction identity(x) { return x; }\nfunction noop() {}\n\nfunction limitRange(min, max, value) {\n  return Math.max(min, Math.min(value, max));\n}\n\n// IE padding hack so that SVG resizes properly.\n// This works across browsers but we only need it for IE.\nconst appendSVGTo = !isBrowserIEorEdge\n  ? div => { return div.append('svg'); }\n  : (div, hwRatio) => {\n    return div\n      .append('div')\n      .style({\n        width: '100%',\n        height: '0',\n        'padding-bottom': (100 * hwRatio) + '%',\n        position: 'relative'\n      })\n      .append('svg')\n      .style({\n        position: 'absolute',\n        top: '0',\n        left: '0'\n      });\n  };\n\n// *** D3 diagram ***\nrequire('./StateViz.css');\n\n// type LayoutNode = {label: string};\n// type StateMap = {[state: string]: LayoutNode};\n\n/**\n * Create a state diagram inside an SVG.\n * Each vertex/edge (node/link) object is also annotated with @.domNode@\n * corresponding to its SVG element.\n *\n * Note: currently, element IDs (e.g. for textPath) will collide if multiple\n * diagrams are on the same document (HTML page).\n * @param  {D3Selection}      container     Container to add the SVG to.\n * @param  {[LayoutNode] | StateMap} nodes  Parameter to D3's force.nodes.\n *   Important: passing a StateMap is recommended when using setPositionTable.\n *   Passing an array will key the state nodes by array index.\n * @param  {[LayoutEdge]}     linkArray     Parameter to D3's force.links.\n */\nclass StateViz {\n  constructor(container, nodes, linkArray) {\n    /* References:\n      [Sticky Force Layout](http://bl.ocks.org/mbostock/3750558) demonstrates\n      drag to position and double-click to release.\n\n      [Graph with labeled edges](http://bl.ocks.org/jhb/5955887) demonstrates\n      arrow edges with auto-rotated labels.\n    */\n\n    /* eslint-disable no-invalid-this */ // eslint is not familiar with D3\n    const w = 800;\n    const h = 500;\n    const linkDistance = 140;\n    const nodeRadius = 20;\n\n    const colors = d3.scale.category10();\n\n    const svg = appendSVGTo(container, h/w);\n    svg.attr({\n      'viewBox': [0, 0, w, h].join(' '),\n      'version': '1.1',\n      ':xmlns': 'http://www.w3.org/2000/svg',\n      ':xmlns:xlink': 'http://www.w3.org/1999/xlink'\n    });\n\n    // Force Layout\n\n    // drag event handlers\n    function dragstart(d) {\n      d.fixed = true;\n      svg.transition()\n        .style('box-shadow', 'inset 0 0 1px gold');\n    }\n    function dragend() {\n      svg.transition()\n        .style('box-shadow', null);\n    }\n    function releasenode(d) {\n      d.fixed = false;\n      force.resume();\n    }\n\n    // set up force layout\n    const nodeArray = nodes instanceof Array ? nodes : _.values(nodes);\n    this.__stateMap = nodes;\n\n    var force = d3.layout.force()\n      .nodes(nodeArray)\n      .links(linkArray)\n      .size([w,h])\n      .linkDistance([linkDistance])\n      .charge([-500])\n      .theta(0.1)\n      .gravity(0.05)\n      .start();\n\n    const drag = force.drag()\n      .on('dragstart', dragstart)\n      .on('dragend', dragend);\n\n    // Edges\n    const edgeCounter = new EdgeCounter(linkArray);\n\n    const edgeselection = svg.selectAll('.edgepath')\n      .data(linkArray)\n      .enter();\n\n    const edgegroups = edgeselection.append('g');\n\n    const labelAbove = (d, i) => { return String(-1.1*(i+1)) + 'em'; };\n    const labelBelow = (d, i) => { return String(0.6+ 1.1*(i+1)) + 'em'; };\n\n    edgegroups.each(function (edgeD, edgeIndex) {\n      const group = d3.select(this);\n      const edgepath = group\n        .append('path')\n        .attr({'class': 'edgepath',\n          'id': 'edgepath'+edgeIndex })\n        .each(function (d) { d.domNode = this; });\n\n      const labels = group.selectAll('.edgelabel')\n        .data(edgeD.labels).enter()\n        .append('text')\n        .attr('class', 'edgelabel');\n      labels.append('textPath')\n        .attr('xlink:href', () => { return '#edgepath'+edgeIndex; })\n        .attr('startOffset', '50%')\n        .text(identity);\n      /* To reduce JS computation, label positioning varies by edge shape:\n          * Straight edges can use a fixed 'dy' value.\n          * Loops cannot use 'dy' since it increases letter spacing\n            as labels get farther from the path. Instead, since a loop's shape\n            is fixed, it allows a fixed translate 'transform'.\n          * Arcs are bent and their shape is not fixed, so neither 'dy'\n            nor 'transform' can be constant.\n            Fortunately the curvature is slight enough that a fixed 'dy'\n            looks good enough without resorting to dynamic translations.\n      */\n      const shape = edgeCounter.shapeForEdge(edgeD);\n      let isFlipped;\n      edgeD.getPath = edgePathFor(nodeRadius, shape, edgeD);\n      switch (shape) {\n        case EdgeShape.straight:\n          labels.attr('dy', labelAbove);\n          edgeD.refreshLabels = () => {\n            // flip edge labels that are upside-down\n            labels.attr('transform', function () {\n              if (edgeD.target.x < edgeD.source.x) {\n                const c = rectCenter(this.getBBox());\n                return 'rotate(180 '+c.x+' '+c.y+')';\n              } else {\n                return null;\n              }\n            });\n          };\n          break;\n        case EdgeShape.arc:\n          edgeD.refreshLabels = () => {\n            const shouldFlip = edgeD.target.x < edgeD.source.x;\n            if (shouldFlip !== isFlipped) {\n              edgepath.classed('reversed-arc', shouldFlip);\n              labels.attr('dy', shouldFlip ? labelBelow : labelAbove);\n              isFlipped = shouldFlip;\n            }\n          };\n          break;\n        case EdgeShape.loop:\n          labels.attr('transform', (d, i) => {\n            return 'translate(' + String(8*(i+1)) + ' ' + String(-8*(i+1)) + ')';\n          });\n          edgeD.refreshLabels = noop;\n          break;\n      }\n    });\n    const edgepaths = edgegroups.selectAll('.edgepath');\n\n    // Nodes\n    // note: nodes are added after edges so as to paint over excess edge lines\n    const nodeSelection = svg.selectAll('.node')\n      .data(nodeArray)\n      .enter();\n\n    const nodecircles = nodeSelection\n      .append('circle')\n      .attr('class', 'node')\n      .attr('r', nodeRadius)\n      .style('fill', (d, i) => { return colors(i); })\n      .each(function (d) { d.domNode = this; })\n      .on('dblclick', releasenode)\n      .call(drag);\n\n    const nodelabels = nodeSelection\n      .append('text')\n      .attr('class', 'nodelabel')\n      .attr('dy', '0.25em') /* dy doesn't work in CSS */\n      .text(d => { return d.label; });\n\n    // Arrowheads\n    const svgdefs = svg.append('defs');\n    svgdefs.selectAll('marker')\n      .data(['arrowhead', 'active-arrowhead', 'reversed-arrowhead', 'reversed-active-arrowhead'])\n      .enter().append('marker')\n      .attr({'id': function (d) { return d; },\n        'viewBox':'0 -5 10 10',\n        'refX': function (d) {\n          return (d.lastIndexOf('reversed-', 0) === 0) ? 0 : 10;\n        },\n        'orient':'auto',\n        'markerWidth':10,\n        'markerHeight':10\n      })\n      .append('path')\n      .attr('d', 'M 0 -5 L 10 0 L 0 5 Z')\n      .attr('transform', d => {\n        return (d.lastIndexOf('reversed-', 0) === 0) ? 'rotate(180 5 0)' : null;\n      });\n\n    const svgCSS =\n      '.edgepath {' +\n      '  marker-end: url(#arrowhead);' +\n      '}' +\n      '.edgepath.active-edge {' +\n      '  marker-end: url(#active-arrowhead);' +\n      '}' +\n      '.edgepath.reversed-arc {' +\n      '  marker-start: url(#reversed-arrowhead);' +\n      '  marker-end: none;' +\n      '}' +\n      '.edgepath.active-edge.reversed-arc {' +\n      '  marker-start: url(#reversed-active-arrowhead);' +\n      '  marker-end: none;' +\n      '}';\n    svg.append('style').each(function () {\n      if (this.styleSheet) {\n        this.styleSheet.cssText = svgCSS;\n      } else {\n        this.textContent = svgCSS;\n      }\n    });\n\n    // Force Layout Update\n    force.on('tick', () => {\n      // Keep coordinates in bounds. http://bl.ocks.org/mbostock/1129492\n      // NB. Bounding can cause node centers to coincide, especially at corners.\n      nodecircles.attr({cx: function (d) { return d.x = limitRange(nodeRadius, w - nodeRadius, d.x); },\n        cy: function (d) { return d.y = limitRange(nodeRadius, h - nodeRadius, d.y); }\n      });\n\n      nodelabels.attr('x', d => { return d.x; })\n        .attr('y', d => { return d.y; });\n\n      edgepaths.attr('d', d => { return d.getPath(); });\n\n      edgegroups.each(d => { d.refreshLabels(); });\n\n      // Conserve CPU when layout is fully fixed\n      if (nodeArray.every(d => { return d.fixed; })) {\n        force.stop();\n      }\n    });\n    this.force = force;\n    /* eslint-enable no-invalid-this */\n  }\n\n  get positionTable() { return getPositionTable(this.__stateMap); }\n\n  set positionTable(posTable) {\n    setPositionTable(posTable, this.__stateMap);\n    // ensure that a cooled layout will update\n    this.force.resume();\n  }\n}\n\n// Positioning\n\n// {[key: State]: Node} -> PositionTable\nconst getPositionTable = _.mapValues(_.pick(['x', 'y', 'px', 'py', 'fixed']));\n\n// Tag nodes w/ positions. Mutates the node map.\n// PositionTable -> {[key: State]: Node} -> void\nfunction setPositionTable(posTable, stateMap) {\n  _.forEach((node, state) => {\n    const position = posTable[state];\n    if (position !== undefined) {\n      assign(node, position);\n    }\n  }, stateMap);\n}\n\n\nmodule.exports = StateViz;\n","'use strict';\nconst _ = require('lodash/fp');\n\n// Bidirectional infinite tape\nclass Tape {\n  constructor(blank, input) {\n    Object.defineProperty(this, 'blank', {\n      value: blank,\n      writable: false,\n      enumerable: true\n    });\n    // zipper data structure\n    // INVARIANTS: tape.before can be empty, tape.after must be nonempty.\n    // before: cells before the head (in order; left to right).\n    // after:  cells after and including the head (in reverse; right to left).\n    this.tape = {\n      before: [],\n      after: (input == null || input.length == 0) ? [blank] : input.slice().reverse(),\n      toString: function () {\n        return this.before.join('') + 'ðŸ”Ž' + this.after.slice().reverse().join('');\n      }\n    };\n  }\n\n  // Read the value at the tape head.\n  read() {\n    return _.last(this.tape.after);\n  }\n\n  write(symbol) {\n    this.tape.after[this.tape.after.length - 1] = symbol;\n  }\n\n  headRight() {\n    const { before, after } = this.tape;\n    before.push(after.pop());\n    if (_.isEmpty(after)) {\n      after.push(this.blank);\n    }\n  }\n\n  headLeft() {\n    const { before, after } = this.tape;\n    if (_.isEmpty(before)) {\n      before.push(this.blank);\n    }\n    after.push(before.pop());\n  }\n\n  headNeutral() {\n  }\n\n  toString() {\n    return this.tape.toString();\n  }\n\n  // for tape visualization. not part of TM definition.\n  // Read the value at an offset from the tape head.\n  // 0 is the tape head. + is to the right, - to the left.\n  readOffset(i) {\n    const { tape } = this;\n    if (i >= 0) {\n      // right side: offset [0..length-1] â†¦ array index [length-1..0]\n      return (i <= tape.after.length - 1) ? tape.after[tape.after.length - 1 - i] : this.blank;\n    } else {\n      // left side: offset [-1..-length] â†¦ array index [length-1..0]\n      return (i >= -tape.before.length) ? tape.before[tape.before.length + i] : this.blank;\n    }\n  }\n\n  // for tape visualization.\n  // Read the values from an offset range (inclusive of start and end).\n  readRange(start, end) {\n    return _.range(start, end+1).map(function (i) {\n      return this.readOffset(i);\n    }, this);\n  }\n}\n\nmodule.exports = Tape;\n","'use strict';\nconst Tape = require('./Tape.js');\nconst d3   = require('d3');\nrequire('./tape.css');\n\nconst cellWidth = 50;\nconst cellHeight = 50;\n\nfunction initTapeCells(selection) {\n  selection.attr('class', 'tape-cell');\n  selection.append('rect')\n  // the box outline is purely visual, so remove its data binding\n    .datum(null)\n    .attr({'width': cellWidth,\n      'height': cellHeight});\n  selection.append('text')\n    .text(d => { return d; })\n    .attr({'x': cellWidth/2, 'y': cellHeight/2 + 8});\n  return selection;\n}\n\nfunction positionCells(selection, offset) {\n  offset = (offset == null) ? 0 : offset;\n  selection.attr('transform', (d, i) => {\n    return 'translate(' + (-cellWidth+10 + cellWidth*(i+offset)) + ')';\n  });\n  return selection;\n}\n\nfunction repositionWrapper(wrapper) {\n  wrapper.attr('transform', 'translate(0 10)')\n    .transition()\n    .duration(0)\n    .select('.exiting')\n    .remove();\n}\n\n// Tape visualization centered around the tape head.\nclass TapeViz extends Tape {\n  constructor(svg, lookaround, blank, input) {\n    super(blank, input);\n\n    Object.defineProperty(this, 'lookaround', {\n      value: lookaround,\n      writable: false,\n      enumerable: true\n    });\n    Object.defineProperty(this, 'domNode', {\n      value: svg,\n      writable: false,\n      enumerable: true\n    });\n\n    // width is before + head + after, trimming 2 off to show cut-off tape ends\n    const width  = cellWidth * (lookaround+1+lookaround-2) + 2*10;\n    const height = cellHeight + 2*10;\n    svg.attr({\n      'width': '95%',\n      'viewBox': [0, 0, width, height].join(' ')\n    });\n\n    this.wrapper = svg.append('g')\n      .attr('class', 'wrapper')\n      .call(repositionWrapper);\n\n    svg.append('rect')\n      .attr({'id': 'tape-head',\n        'width': (1+1/5) * cellWidth,\n        'height': (1+1/5) * cellHeight,\n        'x': -cellWidth+10/2 + cellWidth*lookaround,\n        'y': 10/2\n      });\n\n    this.wrapper.selectAll('.tape-cell')\n      .data(this.readRange(-lookaround, lookaround))\n      .enter()\n      .append('g')\n      .call(initTapeCells)\n      .call(positionCells)\n    ;\n  }\n\n  // IDEA: chain headLeft/Right to wait for write()?\n  write(symbol) {\n    // don't animate if symbol stays the same\n    if (Tape.prototype.read.call(this) === symbol) {\n      return;\n    }\n    super.write(symbol);\n\n    // remove leftover .exiting in case animation was interrupted\n    this.wrapper.selectAll('.exiting').remove();\n\n    d3.select(this.wrapper[0][0].childNodes[this.lookaround])\n      .datum(symbol)\n      .select('text')\n      .attr('fill-opacity', '1')\n      .attr('stroke-opacity', '1')\n      .transition()\n      .attr('fill-opacity', '0.4')\n      .attr('stroke-opacity', '0.1')\n      .transition()\n      .text(d => { return d; })\n      .attr('fill-opacity', '1')\n      .attr('stroke-opacity', '1')\n      .transition()\n      .duration(0)\n      .attr('fill-opacity', null)\n      .attr('stroke-opacity', null)\n    ;\n  }\n\n  headRight() {\n    super.headRight();\n    // remove leftover .exiting in case animation was interrupted.\n    // Important: call-by-value evaluates the selection argument(s) of 'moveHead' before\n    // before entering the function, so exiting nodes have to be removed beforehand.\n    this.wrapper.selectAll('.exiting').remove();\n    moveHead(this.wrapper,\n      // add to right end\n      this.wrapper.append('g')\n        .datum(this.readOffset(this.lookaround)),\n      // remove from left end\n      this.wrapper.select('.tape-cell'),\n      1, -1);\n  }\n\n  headLeft() {\n    super.headLeft();\n    this.wrapper.selectAll('.exiting').remove();\n    moveHead(this.wrapper,\n      this.wrapper.insert('g', ':first-child')\n        .datum(this.readOffset(-this.lookaround)),\n      this.wrapper.select('.wrapper > .tape-cell:last-of-type'),\n      -1, 0);\n  }\n}\n\nfunction moveHead(wrapper, enter, exit, wOffset, cOffset) {\n  // add to one end\n  enter.call(initTapeCells);\n  // remove from the other end\n  exit.classed('exiting', true);\n  // translate cells forward, and the wrapper backwards\n  wrapper.selectAll('.tape-cell')\n    .call(positionCells, cOffset);\n  wrapper\n    .attr('transform', 'translate(' + (wOffset*cellWidth).toString() + ' 10)')\n    // animate wrapper returning to neutral position\n    .transition()\n    .call(repositionWrapper);\n}\n\nmodule.exports = TapeViz;\n","'use strict';\n// misc. utilities\n\n//////////////////////////////////\n// Utilities for null/undefined //\n//////////////////////////////////\n\n// Assert non-null.\n// Return the value if it is not null or undefined; otherwise, throw an error.\nfunction nonNull(value) {\n  if (value == null) {\n    throw new Error('expected a non-null defined value, but got: ' + String(value));\n  }\n  return value;\n}\n\n// Null coalescing: iff the first argument is null or undefined, return the second.\nfunction coalesce(a, b) {\n  return (a != null) ? a : b;\n}\n\n// Apply a function to a value if non-null, otherwise return the value.\n// (Monadic bind for maybe (option) type.)\n// ((a -> b), ?a) -> ?b\nfunction applyMaybe(f, x) {\n  return (x != null) ? f(x) : x;\n}\n\n// Returns the first function result that is not null or undefined.\n// Otherwise, returns undefined.\n// ((a -> ?b), [a]) -> ?b\nfunction getFirst(f, xs) {\n  for (let i = 0; i < xs.length; ++i) {\n    const val = f(xs[i]);\n    if (val != null) {\n      return val;\n    }\n  }\n}\n\n/////////\n// DOM //\n/////////\n\n/* global document */\n\n/**\n * Concat an array of DOM Nodes into a DocumentFragment.\n * @param  {[Node]} array\n * @return {DocumentFragment}\n */\nfunction toDocFragment(array) {\n  const result = document.createDocumentFragment();\n  array.forEach(result.appendChild.bind(result));\n  return result;\n}\n\n///////////////////////\n// IE/Edge detection //\n///////////////////////\n\n// http://stackoverflow.com/a/9851769\nconst isBrowserIEorEdge = /*@cc_on!@*/false\n  || Boolean(document.documentMode) || Boolean(window.StyleMedia); // eslint-disable-line\n\n\nexports.nonNull = nonNull;\nexports.coalesce = coalesce;\nexports.applyMaybe = applyMaybe;\nexports.getFirst = getFirst;\n\nexports.toDocFragment = toDocFragment;\n\nexports.isBrowserIEorEdge = isBrowserIEorEdge;\n","'use strict';\n/**\n * Lightweight property assignment watching by overriding getters/setters.\n * Intended as a bridge between plain JS properties and other libraries.\n *\n * Inspired by https://gist.github.com/eligrey/384583, which works for\n * data properties only, this works for both data and accessor properties.\n *\n * 2015-11-21\n * @author Andy Li\n */\n\n/**\n * Watches a property for assignment by overriding it with a getter & setter\n * on top of the previous value or accessors.\n *\n * The handler can intercept assignments by returning a different value.\n * Watching an unwritable/unsettable property does nothing, but trying to watch\n * a non-existent or non-configurable property fails fast with TypeError.\n * @param  {!Object} thisArg The object that contains the property.\n * @param  {String}  prop    The name of the property to watch.\n * @param            handler The function to call when the property is\n *   assigned to. Important: this function intercepts assignment;\n *   its return value is set as the new value.\n * @throws {TypeError} if object is null or does not have the property\n * @throws {TypeError} if thisArg.prop is non-configurable\n * @return {?Object}         The previous property descriptor, or null if the\n *   property is not writable/settable.\n */\nfunction watch(thisArg, prop, handler) {\n  const desc = Object.getOwnPropertyDescriptor(thisArg, prop);\n  // check pre-conditions: existent, configurable, writable/settable\n  if (desc === undefined) {\n    throw new TypeError('Cannot watch nonexistent property \\''+prop+'\\'');\n  } else if (!desc.configurable) {\n    throw new TypeError('Cannot watch non-configurable property \\''+prop+'\\'');\n  } else if (!desc.writable && desc.set === undefined) {\n    return; // no-op since property can't change without reconfiguration\n  }\n\n  const accessors = (() => {\n    if (desc.set) {\n      // case: .get/.set\n      return {\n        get: desc.get,\n        set: function (newval) {\n          return desc.set.call(thisArg, handler.call(thisArg, prop, thisArg[prop], newval));\n        }\n      };\n    } else {\n      // case: .value\n      let val = desc.value;\n      return {\n        get: function () {\n          return val;\n        },\n        set: function (newval) {\n          return val = handler.call(thisArg, prop, val, newval);\n        }\n      };\n    }\n  })();\n  Object.defineProperty(thisArg, prop, accessors);\n\n  return desc;\n}\n\n/**\n * {@link watch} that, if successful, also calls the handler once with\n *   the current value (by setting it).\n * @see watch\n */\nfunction watchInit(thisArg, prop, handler) {\n  const value = thisArg[prop];\n  const desc = watch(thisArg, prop, handler);\n  if (desc) { thisArg[prop] = value; }\n  return desc;\n}\n\nif (typeof exports === 'object') {\n  exports.watch = watch;\n  exports.watchInit = watchInit;\n}\n","module.exports = _;","module.exports = d3;","module.exports = lodash;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// module exports must be returned from runtime so entry inlining is disabled\n// startup\n// Load entry module and return exports\nreturn __webpack_require__(6095);\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop)","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"/build/\";"],"sourceRoot":""}